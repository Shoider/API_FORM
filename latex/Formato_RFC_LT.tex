\input{Datos.txt}
%**Giro de página**
\documentclass[letterpaper,11pt,landscape]{article}

\usepackage{graphicx}
\usepackage{longtable}

\usepackage{datatool}
%%Carga de csv's 
\DTLloaddb{ALTASINTER}{ALTASINTER.csv}
\DTLloaddb{ALTASDES}{ALTASDES.csv}
\DTLloaddb{ALTASUSUA}{ALTASUSUA.csv}
\DTLloaddb{ALTASADMIN}{ALTASADMIN.csv}
\DTLloaddb{ALTASOTRO}{ALTASOTRO.csv}

\DTLloaddb{BAJASINTER}{BAJASINTER.csv}
\DTLloaddb{BAJASDES}{BAJASDES.csv}
\DTLloaddb{BAJASUSUA}{BAJASUSUA.csv}
\DTLloaddb{BAJASADMIN}{BAJASADMIN.csv}
\DTLloaddb{BAJASOTRO}{BAJASOTRO.csv}

%**Uso de paqueteria de if**
\usepackage{ifthen}
\usepackage{filecontents}
\usepackage{setspace}
\usepackage{tabularx}

% ** Fuente **
\usepackage{fontspec}
\setmainfont{Noto Sans}

% *** Margenes y Tamaño de Hoja
\usepackage{geometry}
\geometry{
left = 15mm,
right = 15mm,
top = 45mm,
bottom = 15mm,
headheight = 28mm
}

% *** Imagenes ***
\usepackage{graphicx}
\graphicspath{./imagenes}
\usepackage{float}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{tabularray}

\UseTblrLibrary{booktabs}
% Quita las leyenda de longtblr
\DefTblrTemplate{contfoot-text}{default}{}
\DefTblrTemplate{conthead-text}{default}{}
\DefTblrTemplate{capcont}{default}{}
\SetTblrTemplate{contfoot-text}{default}
\SetTblrTemplate{conthead-text}{default}
\SetTblrTemplate{capcont}{default}


% *** Fecha ***
\usepackage[useregional]{datetime2}

% *** Encabezado ***
\usepackage{lastpage} 
\usepackage{fancyhdr}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\lhead{
		\begin{tblr}{
		width = \linewidth,
		colspec = {Q[230]Q[507]Q[100]Q[100]},
		row{2} = {c},
		row{3} = {c},
		column{2} = {c},
		cell{1}{1} = {r=4}{c},
		cell{1}{2} = {r=3}{},
		cell{1}{3} = {c},
		cell{1}{4} = {c},
                     cell{4}{3} = {c},
                     cell{4}{4} = {c},
		vlines,
		hline{1,5} = {-}{},
		hline{2-3} = {3-4}{},
		hline{4} = {2-4}{},
	}
	\includegraphics[width=0.2\textwidth]{imagenes/Logo_de_la_Conagua} & {\textbf {COMISIÓN NACIONAL DEL AGUA}\\Gerencia de Tecnologías de Información y Comunicaciones. \\ Subgerencia de Soporte Técnico, Telecomunicaciones y Seguridad.} & \footnotesize HOJA    & {\footnotesize \thepage\ de \pageref{LastPage}} \\
	&                                                                                       &\footnotesize PROCESO   & \footnotesize ACMB \\
	&                                                                                       &{ \footnotesize FECHA \\ 2025} & {\footnotesize Último Cambio\\ Liberado }    \\
	&\textbf { Solicitud de alta baja o cambio en la infraestructura de seguridad de la Comisión Nacional del Agua.}                                       &  { \footnotesize No. Formato \\ \NOFORMATO}       & { \footnotesize ANEXO 17 FORMATO 1}
\end{tblr}
}
\chead{}
\rhead{}
% *** Pie de Pagina
\lfoot{}
\cfoot{}
\rfoot{}

\begin{document}
\sloppy
%%%INFORMACIÓN DEL SOLICITANTE Y ENLACE INFORMATICO
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[100]Q[300]Q[90]Q[90]},
		column{1}={r},
		column{2}={l},                 
		row{1}={c},
                     cell{1}{1} = {c=4}{0.874\linewidth},	
                     cell{2}{3}={r},
                     cell{3}{2} = {c=3}{0.679\linewidth},                    
                     cell{4}{3}={r},	
                     cell{4}{2} = {c=3}{0.679\linewidth},                     
		hlines,
		vlines,
	}        
   \textbf{Información del solicitante:} &  &      &  \\
             Nombre:                &    \NOMS &   {Teléfono/Extensión:}&\EXTS\\
             Puesto:&\PUESTOS\\  Área: &\AREAS            
\end{longtblr}

\newboolean{enlace}
\setboolean{enlace}{\ENLACE}
\ifthenelse{\boolean{enlace}}{
\vspace{-37pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[100]Q[300]Q[90]Q[90]},
		column{1}={r},
		column{2}={l},             
		row{1}={c},
                     cell{1}{1} = {c=4}{0.874\linewidth},	
                     cell{2}{3}={r},                     
		hlines,
		vlines,
	}
             \textbf{Información del enlace informático:} &  &      &  \\
             Nombre:                &   \NOMEI  &   {Teléfono/Extensión:}&\EXTEI       
           
\end{longtblr}}

\vspace{-15pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[203]Q[200]Q[200]Q[200]},
		column{1}={r},
		column{2}={l},   
		row{1}={c},
		row{5}={c},
		row{8}={c},
		row{9}={l},
		row{10}={c},
		row{11}={l},
                     cell{1}{1} = {c=4}{0.679\linewidth},
		cell{2}{3} = {r},
		cell{2}{4} = {c},
                     cell{5}{1} = {c=4}{0.679\linewidth},
                     cell{7}{3} = {c=2}{0.379\linewidth},
                     cell{3}{2} = {c=3}{0.679\linewidth},
                     cell{4}{2} = {c=3}{0.679\linewidth},
                     row{6}={c},
                     cell{7}{1}={c},
                     cell{7}{2}={c},    
		cell{8}{1} = {c=4}{0.679\linewidth}, 
		cell{9}{1} = {c=4}{0.679\linewidth},      
		cell{10}{1} = {c=4}{0.679\linewidth}, 
		cell{11}{1} = {c=4}{0.679\linewidth},               
                     	hlines,
		vlines,
	}
          
          \textbf{Información de la solicitud:} &  &      &  \\
	Numero de ticket: & \NOTICKET & {Fecha de solicitud:}   & \today       \\
          {Memorando / Atenta nota:}&\MEMO\\
         Descripción breve:&  \DESCBREVE\\
            \textbf {Tipo de Cambio:} &\\
            Intersistemas (\INTER) & Administrativo (\ADMIN) & Desarrollador (\DES )& Usuario(\USUA)\\
           Otro (\OTRO )& Describa brevemente:&\DESOTRO\\   
           \textbf{Descripción detallada:} \\ \DESDET\\
	\textbf{Justificación:} \\ \JUSTIFICA  
           
                 
\end{longtblr}

%%%TABLAS DE ALTAS BAJAS Y CAMBIOS
%%%PARA ALTAS
\newboolean{altasinter}
\setboolean{altasinter}{\ALTASINTER} 
\newboolean{altasadmin}
\setboolean{altasadmin}{\ALTASADMIN} 
\newboolean{altasdes}
\setboolean{altasdes}{\ALTASDES} 
\newboolean{altasusua}
\setboolean{altasusua}{\ALTASUSUA} 
\newboolean{altasotro}
\setboolean{altasotro}{\ALTASOTRO} 


%%PARA BAJAS
\newboolean{bajasinter}
\setboolean{bajasinter}{\BAJASINTER} 
\newboolean{bajasadmin}
\setboolean{bajasadmin}{\BAJASADMIN} 
\newboolean{bajasdes}
\setboolean{bajasdes}{\BAJASDES} 
\newboolean{bajasusua}
\setboolean{bajasusua}{\BAJASUSUA} 
\newboolean{bajasotro}
\setboolean{bajasotro}{\BAJASOTRO} 

%% Para Temporalidades
\newboolean{haytemporal}

\clearpage
%%%%%%%
%%%%INTERSISTEMAS
\newboolean{inter}
\setboolean{inter}{\INTERBOOL} 
\ifthenelse{\boolean{inter}}
{
%%ALTASINTERSISTEMAS ENCABEZADO
\ifthenelse{\boolean{altasinter}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[0.7]Q[1.15]Q[1.85]Q[0.7]Q[1.15]Q[1.85]Q[1]Q[0.7]},
		cells = {c},  
		cell{1}{1}={c=9}{0.978\linewidth},          
		cell{2}{1}={c=9}{0.978\linewidth},        
		hlines,
		vlines,
	}
	
           \textbf {Sección A.- Comunicación intersistemas}\\
	\textbf{ALTAS} \\
	\textbf{No°}&\textbf {Sistema Origen}&\textbf{Función o rol de \\servidor(es) \\origen}&
	\textbf{Dirección(es) IP/NAT servidor(es) \\origen}&\textbf{Sistema\\ Destino} &
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%ALTASINTERSISTEMAS CONTENIDO DE TABLA
\DTLforeach*{ALTASINTER}{\No=N, \SistemaOri=SO, \FuncionOri=FRO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec = {Q[0.5]Q[0.7]Q[1.15]Q[1.85]Q[0.7]Q[1.15]Q[1.85]Q[1]Q[0.7]},                     
  hlines,
  vlines,
                     cells={c},
 }
\No&\SistemaOri&\FuncionOri&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}%%FIN CONDICIONAL IF

%%%%%TEMPORALIDAD INTERSISTEMAS 
\setboolean{haytemporal}{\HAYTEMPORALINTER} 
\ifthenelse{\boolean{haytemporal}}
{
\vspace{-20pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		cells = {c},
		row{2} = {},
		hlines,
		vlines,
	}
	\textbf{Temporalidad de los cambios} \\ \TEMPOINTER
\end{longtblr}
}%%%TEMPORALIDAD

%%%%%%%%
%%BAJAS INTERSISTEMAS ENCABEZADO
\ifthenelse{\boolean{bajasinter}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[0.7]Q[1.15]Q[1.85]Q[0.7]Q[1.15]Q[1.85]Q[1]Q[0.7]},
		cells = {c},		
		cell{1}{1}={c=9}{0.978\linewidth},          
		cell{2}{1}={c=9}{0.978\linewidth},    
		hlines,
		vlines,
	}
	\textbf{Sección A.- Comunicación intersistemas}\\
	\textbf{BAJAS} \\	
	\textbf{No°}&\textbf {Sistema Origen}&\textbf{Función o rol de \\servidor(es) \\origen}&
	\textbf{Dirección(es) IP/NAT servidor(es) \\origen}&\textbf{Sistema\\ Destino} &
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}
%%BAJASINTERSISTEMAS CONTENIDO DE TABLA
\DTLforeach*{BAJASINTER}{\No=N, \SistemaOri=SO, \FuncionOri=FRO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec = {Q[0.5]Q[0.7]Q[1.15]Q[1.85]Q[0.7]Q[1.15]Q[1.85]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\SistemaOri&\FuncionOri&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}%%FIN CONDICIONAL
}%%FIN DE INTERSISTEMAS


%%%%ADMINISTRATIVOS
\newboolean{admin}
\setboolean{admin}{\ADMINBOOL} 
\ifthenelse{\boolean{admin}}
{
%%ALTASADMIN ENCABEZADO
\ifthenelse{\boolean{altasadmin}}
{
\setboolean{haytemporal}{\HAYTEMPORALADMIN} 
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},	
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}
	\textbf{Sección B.- Accesos administrativos}\\
	\textbf{ALTAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ administrador\\(es)}&\textbf{Dirección(es) IP servidor(es) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

% ALTAS ADMINISTRATIVOS CONTENIDO DE LA TABLA
\DTLforeach*{ALTASADMIN}{\No=N, \NombreAdmin=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\NombreAdmin&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
} 
%%%%TEMPORALIDADES ADMIN

\ifthenelse{\boolean{haytemporal}}
{
\vspace{-20pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		cells = {c},
		row{2} = {},
		hlines,
		vlines,
	}
	\textbf{Temporalidad de los cambios} \\ \TEMPOADMIN
\end{longtblr}
}%%TEMPORALID ADMIN

%%BAJASADMIN ENCABEZADO
\ifthenelse{\boolean{bajasadmin}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},  
		hlines,
		vlines,
	}
	\textbf{Sección B.- Accesos administrativos}\\
	\textbf{BAJAS} \\

	\textbf{No°}&\textbf {Nombre(s) de \\ administrador\\(es)}&\textbf{Dirección(es) IP servidor(es) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%% BAJAS ADMIN CONTENIDO DE LA TABLA
\DTLforeach*{BAJASADMIN}{\No=N, \NombreAdmin=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\NombreAdmin&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}
}%%FIN DE ADMINISTRATIVOS


%%%%DESARROLLADORES
\newboolean{des}
\setboolean{des}{\DESBOOL} 
\ifthenelse{\boolean{des}}
{
%%ALTASDES ENCABEZADO
\ifthenelse{\boolean{altasdes}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},	
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}
	\textbf{Sección C.- Accesos de desarrollador}\\
	\textbf{ALTAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ desarrollador\\(es)}&\textbf{Dirección(es) IP dispositivo(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

% ALTASDESARROLLADORES CONTENIDO DE LA TABLA
\DTLforeach*{ALTASDES}{\No=N, \NombreDes=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
vlines,
                     cells={c},
 }
\No&\NombreDes&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}
%%%%%%%%

%%%%%TEMPORALIDAD DESARROLLADORES 
\setboolean{haytemporal}{\HAYTEMPORALDES} 
\ifthenelse{\boolean{haytemporal}}
{
\vspace{-20pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		cells = {c},
		row{2} = {},
		hlines,
		vlines,
	}
	\textbf{Temporalidad de los cambios} \\ \TEMPODES
\end{longtblr}
} %TEMPORALIDAD 

%%BAJAS DES ENCABEZADO
\ifthenelse{\boolean{bajasdes}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}	
	\textbf{Sección C.- Accesos de desarrollador}\\
	\textbf{BAJAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ desarrollador\\(es)}&\textbf{Dirección(es) IP dispositivo(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Función o rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

% BAJAS DESARROLLADORES CONTENIDO DE LA TABLA
\DTLforeach*{BAJASDES}{\No=N, \NombreDes=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\NombreDes&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}
}%%FIN DE DESARROLLADORES


%%%%USUARIO
\newboolean{usua}
\setboolean{usua}{\USUABOOL} 
\ifthenelse{\boolean{usua}}
{
%%ALTAS USUA ENCABEZADO
\ifthenelse{\boolean{altasusua}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}	
	\textbf{Sección D.- Accesos de usuario}\\
	\textbf{ALTAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ usuario(s) \\o zona(s)\\origen}&\textbf{Segmento(s)/\\dirección(es)IP(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%ALTASUSUARIO CONTENIDO DE LA TABLA
\DTLforeach*{ALTASUSUA}{\No=N, \NombreUsua=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
vlines,
                     cells={c},
 }
\No&\NombreUsua&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}

%%%%%TEMPORALIDAD USUARIOS 
\setboolean{haytemporal}{\HAYTEMPORALUSUA} 
\ifthenelse{\boolean{haytemporal}}
{
\vspace{-20pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		cells = {c},
		row{2} = {},
		hlines,
		vlines,
	}
	\textbf{Temporalidad de los cambios} \\ \TEMPOUSUA
\end{longtblr}
} %% TEMPORAL

%%BAJASUSUA ENCABEZADO
\ifthenelse{\boolean{bajasusua}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}
	\textbf{Sección D.- Accesos de usuario}\\
	\textbf{BAJAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ usuario(s) \\o zona(s)\\origen}&\textbf{Segmento(s)/\\dirección(es)IP(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%BAJASUSUARIO CONTENIDO DE LA TABLA
\DTLforeach*{BAJASUSUA}{\No=N, \NombreUsua=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\NombreUsua&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}
}%%FIN DE USUARIOS

%%%%OTRO

\setboolean{usua}{\OTROBOOL} 
\ifthenelse{\boolean{usua}}
{
%%ALTAS OTRO ENCABEZADO
\ifthenelse{\boolean{altasotro}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}	
	\textbf{Sección E.- Otros}\\
	\textbf{ALTAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ usuario(s) \\o zona(s)\\origen}&\textbf{Segmento(s)/\\dirección(es)IP(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%ALTASUSUARIO CONTENIDO DE LA TABLA
\DTLforeach*{ALTASOTRO}{\No=N, \NombreUsua=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
vlines,
                     cells={c},
 }
\No&\NombreUsua&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}

%%%%%TEMPORALIDAD OTRO
\setboolean{haytemporal}{\HAYTEMPORALOTRO} 
\ifthenelse{\boolean{haytemporal}}
{
\vspace{-20pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		cells = {c},
		row{2} = {},
		hlines,
		vlines,
	}
	\textbf{Temporalidad de los cambios} \\ \TEMPOOTRO
\end{longtblr}
} %% TEMPORAL

%%BAJAS OTRO ENCABEZADO
\ifthenelse{\boolean{bajasotro}}
{
\vspace{-25pt}
\begin{longtblr}[
	label = none,
	entry = none,
	]{
		width = \linewidth,
		colspec = {Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},
		cells = {c},
		cell{1}{1}={c=8}{0.978\linewidth},          
		cell{2}{1}={c=8}{0.978\linewidth},    
		hlines,
		vlines,
	}
	\textbf{Sección E.- Otros}\\
	\textbf{BAJAS} \\
	\textbf{No°}&\textbf {Nombre(s) de \\ usuario(s) \\o zona(s)\\origen}&\textbf{Segmento(s)/\\dirección(es)IP(s) \\origen}&
	\textbf{Sistema asociado a \\ servidor(es) destino}&
	\textbf{Rol de \\servidor(es) \\destino}&\textbf{Dirección(es) IP/NAT servidor(es) \\destino}&
	\textbf{Protocolo\\ TCP o UDP}&\textbf{Puertos}
\end{longtblr}

%BAJAS OTRO CONTENIDO DE LA TABLA
\DTLforeach*{BAJASOTRO}{\No=N, \NombreUsua=SO, \IPOri=IPO, \SistemaDes=SD, \FuncionDes=FRD, \IPDes=IPD, \Protocolo=PRO, \Puertos=PUER}
{
\vspace{-37pt}
 \begin{longtblr}[
 label = none,
 entry = none,
 ]{
  width = \linewidth,
  colspec ={Q[0.5]Q[1.25]Q[2]Q[1.25]Q[1.3]Q[2]Q[1]Q[0.7]},                     
  hlines,
 vlines,
                     cells={c},
 }
\No&\NombreUsua&\IPOri&\SistemaDes& \FuncionDes&\IPDes&\Protocolo& \Puertos
\end{longtblr}
}
}
}%%FIN DE OTRO



\par 
\clearpage
%%%..... POLÍTICAS
\textbf{\large Políticas y lineamientos:}
{ \small \begin{enumerate}
	        \item El formato deberá estar debidamente llenado y contener toda la información requerida facilitando la aplicación expedita de las configuraciones solicitadas. Es responsabilidad del solicitante recabar la información con los Administradores de los sistemas o Áreas involucradas.
			\item El solicitante deberá presentar este formato adjuntando el Memorando y número de reporte de Mesa de servicio asociado, sin los cuales no se podrá atender su solicitud.
			\item El solicitante deberá proporcionar la dirección IP física y en caso de utilizarse, la dirección IP NAT, por cada servidor involucrado. De no proporcionarse la dirección IP NAT, las reglas de cortafuegos se configurarán por defecto con la dirección IP del adaptador de red de los servidores y corresponderá al Administrador del sistema aplicar los cambios en el sistema o servidores para lograr establecer la comunicación.
			\item Para el traslado de permisos de una dirección IP a otra, se deberá proporcionar la dirección IP anterior además de llenar la sección de ALTAS con los permisos que se requieren aplicar a la nueva dirección IP. Por cuestiones de seguridad se eliminarán todos los accesos sobre la dirección IP anterior y en caso de requerir algún acceso sobre dicha dirección, se deberá generar una nueva solicitud: memorando, reporte y formato SdC. Si el solicitante NO indica que se trata de un traslado de permisos, éste será responsable de cualquier acceso no autorizado que se derive de los permisos de la dirección IP anterior al no tramitar la baja correspondiente.
			\item La Solicitud de Cambios en el Cortafuegos (SdC) será solicitada únicamente por los Administradores de cada sistema una vez que se apliquen los permisos de acceso en el propio sistema y se aperturen los accesos en los cortafuegos locales de los servidores involucrados.
			\item Es responsabilidad de los administradores de cada servidor y/o Sistema llevar un control de las direcciones IP’s con acceso al servidor y/o sistema que administra.
			\item Al firmar el solicitante se da por enterado de las políticas del servicio y acepta la responsabilidad de cualquier materialización de los riesgos derivados de las aperturas de comunicaciones asociadas al presente control de cambios.

\end{enumerate}
\newboolean{regional}
\setboolean{regional}{\REGIONAL}


%%AMBOS
\ifthenelse{\boolean{regional}}{
         	\begin{longtblr}[
	label = none,
	entry = none,
	]{
			width = \linewidth,
			colspec = {Q[200]Q[200]Q[200]},
			row{1} = {c},
                                row{2}={c},
                                cell{2}{1} = {c=2}{0.942\linewidth},
		}
		{\normalsize Gerente o director local que autoriza\\[1cm] \rule{6cm}{0.5mm}\\\NOMBREJEFE\\\PUESTOJEFE} & 
                   {\normalsize Usuario que acepta.\\[1cm] \rule{6cm}{0.5mm}\\\NOMS\\\PUESTOS} &
                   {\normalsize Enlace Informático\\[1cm] \rule{6cm}{0.5mm}\\\NOMEI}
	\end{longtblr}
}{
\begin{longtblr}[
	label = none,
	entry = none,
	]{
			width = \linewidth,
			colspec = {Q[200]Q[200]Q[200]},
			row{1} = {c},
            row{2}={c},
            cell{2}{1} = {c=2}{0.942\linewidth},
		}                                                                                                   
		{\normalsize Gerente o director local que autoriza\\[1cm] \rule{6cm}{0.5mm}\\\NOMBREJEFE\\\PUESTOJEFE} & 
        {\normalsize Usuario que acepta.\\[1cm] \rule{6cm}{0.5mm}\\\NOMS\\\PUESTOS} 
	\end{longtblr}}
\end{document}